\documentclass[../thesis.tex]{subfiles}

\begin{document}

\chapter{Event reconstruction}
\label{chap:recon}

\section{Introduction}

\autoref{chap:calib} discussed the process of taking the raw ADC and TDC values of PMT hits, as measured by the front-end electronics, and converting those values, channel-by-channel, into the more useful quantities of hit charge (in photoelectrons) and hit time (in, e.g., nanoseconds). The next step is to combine information from all of the channels in order to derive properties of the event as a whole, such as the amount of deposited energy and the approximate location of the vertex. This is the purpose of \emph{reconstruction.}

Reconstruction begins with the calculation of the total observed charge (i.e. photoelectron count) by summing hits across all channels, with a correction for the presence of any inactive channels. This \emph{nominal charge} is then converted into \emph{visible energy}, in MeV, according to an energy scale determined using regular (weekly or more) calibrations. At the same time, the distribution of charge across PMTs is used to estimate the location within the AD of the event. The position is then used to apply a \emph{nonuniformity} adjustment to the visible energy, to correct for the position-dependent response of the detector. This gives the \emph{reconstructed energy}, which is used in most subsequent analysis stages.

The reconstructed energy should not be regarded as a best estimate of the true energy deposited by the event, given the complexities involved in the nonlinearity of the scintillator and its varying responses to different particle types. Rather, reconstructed energy should be considered a \emph{position-corrected measure of the total observed amount of light}, and hence should be regarded as proportional to the total amount of light produced in the scintillator. Due to the calibration methods used, reconstructed energy \emph{does} agree (by construction) with deposited energy for the 8~MeV gamma cascade from nGd capture, but this is only a special case.

Daya Bay has developed multiple independent reconstruction algorithms. The two that have been widely used in published results are known as AdSimple and AdScaled. They differ primarily in their calibration procedures, their vertex reconstruction algorithms, and their methods of correcting for nonuniformity. Both give consistent results in the oscillation analysis, and both will be detailed in this chapter, but only AdSimple will be used in our analysis.

\section{Energy reconstruction}
\label{sec:reconEnergy}

\subsection{Event charge determination}
\label{sec:reconEnergyChage}

The first step in the energy reconstruction is to determine the total \emph{charge}, i.e., number of photoelectrons, observed from the underlying interaction. Given that each readout window is about 1.3~$\mu$s wide, and light from an interaction will only take a few dozen ns to propagate across the detector, the readout may contain hits that are uncorrelated with the physical event. (Indeed, this behavior is what is exploited in order to measure the gain, as discussed in \autoref{sec:calibCQ}.) Furthermore, the readout may also contain extra \emph{correlated} hits caused by a number of effects, including reflected light, delayed scintillation (XXX really?), ringing in the FEEs, and afterpulsing in the PMTs (XXX check all these; doc-8319, 8732, 8356, 6710, 5612). As such, there are subtleties to consider in choosing which hits to include in the charge sum.

As was shown in \autoref{fig:tdcDist}, physical hits are peaked between TDC values of roughly 950 and 1000, corresponding to about 1545 and 1625~ns before the TDC stop signal (i.e. the trigger).

Active PMT correction, etc.

\subsection{Energy scale calibration}
\label{sec:reconEnergyScale}

\subsection{Nonuniformity correction}
\label{sec:reconEnergyNU}

\subsubsection{Time-dependent nonuniformity}
\label{sec:reconEnergyTDNU}

\subsection{Nonlinearity correction}
\label{sec:reconEnergyNL}

\section{Vertex reconstruction}
\label{sec:reconVertex}

\end{document}